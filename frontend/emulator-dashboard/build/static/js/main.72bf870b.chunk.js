(this["webpackJsonpemulator-dashboard"]=this["webpackJsonpemulator-dashboard"]||[]).push([[0],{34:function(e,t,c){},40:function(e,t,c){},41:function(e,t,c){},42:function(e,t,c){"use strict";c.r(t);var n=c(4),r=c.n(n),s=c(25),a=c.n(s),o=(c(34),c(43));const i="http://localhost:5000/api/hardware";var l=c(1);var d=()=>{const[e,t]=Object(n.useState)([]),[c,r]=Object(n.useState)(null);Object(n.useEffect)((()=>{(async()=>{try{return(await o.a.get("".concat(i,"/list"))).data.devices||[]}catch(e){return console.error("Error fetching devices:",e),[]}})().then(t)}),[]);const s=e=>{(async e=>{try{return(await o.a.get("".concat(i,"/device/").concat(e))).data.device||null}catch(t){return console.error("Error fetching details for device ".concat(e,":"),t),null}})(e).then(r)};return Object(l.jsxs)("div",{children:[Object(l.jsx)("h3",{children:"Devices"}),Object(l.jsx)("ul",{children:e.map((e=>Object(l.jsx)("li",{onClick:()=>s(e.id),children:e.name},e.id)))}),c&&Object(l.jsxs)("div",{children:[Object(l.jsxs)("h4",{children:["Details for ",c.name]}),Object(l.jsx)("pre",{children:JSON.stringify(c,null,2)})]})]})},j=c(8);const b="http://localhost:5000/api/emulator";var h=()=>{const[e,t]=Object(n.useState)([]),[c,r]=Object(n.useState)(null),[s]=Object(n.useState)(null),[a,i]=Object(n.useState)([]);Object(n.useEffect)((()=>{d()}),[]);const d=async()=>{const e=await(async()=>{try{return(await o.a.get("".concat(b,"/active"))).data}catch(e){throw console.error("Error fetching active emulations:",e),e}})();t(e)},h=async e=>{await(async e=>{try{return(await o.a.post("".concat(b,"/stop"),{emulationId:e})).data}catch(t){throw console.error("Error stopping emulation:",t),t}})(e),d()},u=async e=>{const t=await(async e=>{try{return(await o.a.get("".concat(b,"/logs/").concat(e))).data}catch(t){throw console.error("Error fetching emulation logs:",t),t}})(e);i(t)},O=async e=>{const t=await(async e=>{try{return(await o.a.get("".concat(b,"/export-logs/").concat(e),{responseType:"blob"})).data}catch(t){throw console.error("Error exporting logs:",t),t}})(e),c=window.URL.createObjectURL(new Blob([t])),n=document.createElement("a");n.href=c,n.setAttribute("download","emulation_logs_".concat(e,".txt")),document.body.appendChild(n),n.click()};return Object(l.jsxs)("div",{className:"emulator-panel",children:[Object(l.jsx)("h1",{children:"Emulator Dashboard"}),Object(l.jsx)("button",{onClick:async()=>{await(async e=>{try{return(await o.a.post("".concat(b,"/start"),e)).data}catch(t){throw console.error("Error starting emulation:",t),t}})({deviceType:"CustomDevice",firmwareVersion:"1.0.0"}),d()},children:"Start New Emulation"}),Object(l.jsx)("h2",{children:"Active Emulations"}),Object(l.jsx)("ul",{children:e.map((e=>Object(l.jsxs)("li",{children:[e.name," - ",e.status,Object(l.jsx)("button",{onClick:()=>h(e.id),children:"Stop"}),Object(l.jsx)("button",{onClick:()=>u(e.id),children:"View Logs"}),Object(l.jsx)("button",{onClick:()=>O(e.id),children:"Export Logs"})]},e.id)))}),Object(l.jsx)("h2",{children:"Firmware Upload"}),Object(l.jsx)("input",{type:"file",onChange:e=>r(e.target.files[0])}),Object(l.jsx)("button",{onClick:async()=>{c&&await(async e=>{const t=new FormData;t.append("file",e);try{return(await o.a.post("".concat(b,"/upload-firmware"),t,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(c){throw console.error("Error uploading firmware:",c),c}})(c)},children:"Upload"}),Object(l.jsx)("h2",{children:"Other Actions"}),Object(l.jsx)("button",{onClick:async()=>{if(!s)return;const e={eventType:"trigger-action",triggerTime:Date.now()+6e4};await(async(e,t)=>{try{return(await o.a.post("".concat(b,"/set-timed-event"),Object(j.a)({emulationId:e},t))).data}catch(c){throw console.error("Error setting timed event:",c),c}})(s.id,e)},children:"Set Timed Event"}),Object(l.jsx)("button",{onClick:async()=>{s&&await(async e=>{try{return(await o.a.post("".concat(b,"/enable-mirror"),{emulationId:e})).data}catch(t){throw console.error("Error enabling UI mirroring:",t),t}})(s.id)},children:"Enable UI Mirror"}),Object(l.jsx)("h2",{children:"Logs"}),Object(l.jsx)("pre",{children:a.join("\n")})]})},u=c(19);var O=()=>{const[e,t]=Object(n.useState)("wss://test.mosquitto.org:8081"),[c,r]=Object(n.useState)(null),[s,a]=Object(n.useState)(!1),[o,i]=Object(n.useState)(""),[d,j]=Object(n.useState)(""),[b,h]=Object(n.useState)([]),[O,x]=Object(n.useState)([]),[m,p]=Object(n.useState)([]),g=Object(n.useRef)([]);Object(n.useEffect)((()=>()=>{c&&c.end()}),[c]);const y=()=>{c&&o&&d&&(c.publish(o,d),j(""))};return Object(l.jsxs)("div",{className:"mqtt-panel",children:[Object(l.jsx)("h1",{children:"MQTT Communication Panel"}),Object(l.jsxs)("div",{children:[Object(l.jsx)("label",{children:"Broker URL:"}),Object(l.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value),placeholder:"Enter broker URL"}),s?Object(l.jsx)("button",{onClick:()=>{c&&(c.end(),a(!1),r(null))},children:"Disconnect"}):Object(l.jsx)("button",{onClick:()=>{const t=u.a.connect(e,{clientId:"mqtt_client_".concat(Math.random().toString(16).substr(2,8))});t.on("connect",(()=>{a(!0),console.log("Connected to MQTT Broker:",e)})),t.on("message",((e,t)=>{const c={topic:e,message:t.toString(),timestamp:(new Date).toLocaleTimeString()};h((e=>[...e,c]))})),t.on("error",(e=>{console.error("MQTT Error:",e),a(!1)})),r(t)},children:"Connect"})]}),Object(l.jsxs)("div",{children:[Object(l.jsx)("label",{children:"Topic:"}),Object(l.jsx)("input",{type:"text",value:o,onChange:e=>i(e.target.value),placeholder:"Enter topic",disabled:!s}),Object(l.jsx)("button",{onClick:()=>{c&&o&&c.subscribe(o,(e=>{e||(x((e=>[...e,o])),console.log("Subscribed to topic: ".concat(o)))}))},disabled:!s||!o,children:"Subscribe"})]}),Object(l.jsxs)("div",{children:[Object(l.jsx)("h3",{children:"Subscribed Topics"}),Object(l.jsx)("ul",{children:O.map(((e,t)=>Object(l.jsxs)("li",{children:[e," ",Object(l.jsx)("button",{onClick:()=>{return t=e,void(c&&c.unsubscribe(t,(()=>{x((e=>e.filter((e=>e!==t)))),console.log("Unsubscribed from topic: ".concat(t))})));var t},children:"Unsubscribe"})]},t)))})]}),Object(l.jsxs)("div",{children:[Object(l.jsx)("label",{children:"Message:"}),Object(l.jsx)("input",{type:"text",value:d,onChange:e=>j(e.target.value),placeholder:"Enter message",disabled:!s}),Object(l.jsx)("button",{onClick:y,disabled:!s||!o||!d,children:"Publish"})]}),Object(l.jsxs)("div",{children:[Object(l.jsx)("h3",{children:"Scheduled Messages"}),m.map(((e,t)=>Object(l.jsxs)("div",{children:[Object(l.jsxs)("p",{children:[Object(l.jsx)("strong",{children:"Topic:"})," ",e.topic]}),Object(l.jsxs)("p",{children:[Object(l.jsx)("strong",{children:"Message:"})," ",e.message]}),Object(l.jsxs)("p",{children:[Object(l.jsx)("strong",{children:"Scheduled for:"})," ",e.delay,"ms at ",e.time]})]},t))),Object(l.jsx)("button",{onClick:()=>(e=>{if(!o||!d)return void alert("Enter topic and message before scheduling.");const t=setTimeout((()=>{y()}),e);g.current.push(t),p((c=>[...c,{topic:o,message:d,delay:e,id:t,time:(new Date).toLocaleTimeString()}]))})(5e3),children:"Schedule Message (5s)"}),Object(l.jsx)("button",{onClick:()=>{g.current.forEach((e=>clearTimeout(e))),p([])},children:"Cancel Scheduled Messages"})]}),Object(l.jsxs)("div",{children:[Object(l.jsx)("h3",{children:"Received Messages"}),Object(l.jsx)("textarea",{value:b.map((e=>"[".concat(e.timestamp,"] ").concat(e.topic,": ").concat(e.message))).join("\n"),readOnly:!0,rows:"8",cols:"50"})]})]})};var x=()=>{const[e,t]=Object(n.useState)([]),[c,r]=Object(n.useState)(""),[s,a]=Object(n.useState)(115200),[o,i]=Object(n.useState)(!1),[d,j]=Object(n.useState)([]),[b,h]=Object(n.useState)(""),[u,O]=Object(n.useState)(!1),[x,m]=Object(n.useState)(!0),[p,g]=Object(n.useState)([]),y=Object(n.useRef)(null);Object(n.useEffect)((()=>{fetch("/api/serial/ports").then((e=>e.json())).then((e=>t(e))).catch((e=>console.error("Error fetching ports:",e)))}),[]);const v=async()=>{if(!c)return alert("Select a port first!");try{(await fetch("/api/serial/connect",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({port:c,baudRate:s})})).ok?(i(!0),f()):alert("Failed to connect.")}catch(e){console.error("Connection error:",e)}},f=()=>{o&&(y.current=new EventSource("/api/serial/listen"),y.current.onmessage=e=>{const t=e.data;j((e=>[...e,t]))},y.current.onerror=()=>{console.error("Serial stream error."),x&&(console.log("Reconnecting..."),setTimeout(v,2e3))})},w=e=>e.split("").map((e=>e.charCodeAt(0).toString(16))).join(" ");return Object(l.jsxs)("div",{className:"serial-panel",children:[Object(l.jsx)("h2",{children:"Serial Communication Panel"}),Object(l.jsxs)("div",{children:[Object(l.jsx)("label",{children:"Serial Port:"}),Object(l.jsxs)("select",{value:c,onChange:e=>r(e.target.value),disabled:o,children:[Object(l.jsx)("option",{value:"",children:"-- Select a port --"}),e.map(((e,t)=>Object(l.jsx)("option",{value:e,children:e},t)))]})]}),Object(l.jsxs)("div",{children:[Object(l.jsx)("label",{children:"Baud Rate:"}),Object(l.jsx)("input",{type:"number",value:s,onChange:e=>a(parseInt(e.target.value)),disabled:o})]}),Object(l.jsx)("div",{children:o?Object(l.jsx)("button",{onClick:async()=>{try{await fetch("/api/serial/disconnect",{method:"POST"}),i(!1),y.current&&y.current.close()}catch(e){console.error("Disconnection error:",e)}},children:"Disconnect"}):Object(l.jsx)("button",{onClick:v,disabled:!c,children:"Connect"})}),Object(l.jsxs)("div",{children:[Object(l.jsxs)("label",{children:[Object(l.jsx)("input",{type:"checkbox",checked:u,onChange:()=>O(!u)}),"Hex Mode"]}),Object(l.jsx)("br",{}),Object(l.jsxs)("label",{children:[Object(l.jsx)("input",{type:"checkbox",checked:x,onChange:()=>m(!x)}),"Auto Reconnect"]})]}),Object(l.jsxs)("div",{children:[Object(l.jsx)("label",{children:"Send Message:"}),Object(l.jsx)("input",{type:"text",value:b,onChange:e=>h(e.target.value),placeholder:"Enter message",disabled:!o}),Object(l.jsx)("button",{onClick:async()=>{if(b.trim())try{const e=u?w(b):b;await fetch("/api/serial/send",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e})}),g((t=>[...t,e])),h("")}catch(e){console.error("Error sending data:",e)}},disabled:!o||!b,children:"Send"})]}),Object(l.jsxs)("div",{children:[Object(l.jsx)("h3",{children:"Received Data"}),Object(l.jsx)("textarea",{value:d.join("\n"),readOnly:!0,rows:"5",cols:"50"})]}),Object(l.jsxs)("div",{children:[Object(l.jsx)("h3",{children:"Command History"}),Object(l.jsx)("ul",{children:p.map(((e,t)=>Object(l.jsx)("li",{children:e},t)))})]})]})};let m=null,p=0,g=new Set,y={};const v=()=>{m&&m.connected?console.warn("MQTT already connected."):(console.log("Connecting to MQTT broker..."),m=u.a.connect("ws://localhost:1883",{reconnectPeriod:5e3,clientId:"emulator-".concat(Math.random().toString(16).substr(2,8)),clean:!1}),m.on("connect",(()=>{console.log("Connected to MQTT broker."),p=0,g.forEach((e=>m.subscribe(e)))})),m.on("error",(e=>{console.error("MQTT Connection Error:",e),m.end(),f()})),m.on("offline",(()=>{console.warn("MQTT is offline. Attempting to reconnect..."),f()})),m.on("message",((e,t)=>{console.log("Received MQTT message on ".concat(e,":"),t.toString()),y[e]&&y[e].forEach((e=>e(t.toString())))})))},f=()=>{p>=10?console.error("Max MQTT reconnect attempts reached. Manual restart required."):(p++,console.log("Reconnecting to MQTT broker (Attempt ".concat(p,"/").concat(10,")...")),setTimeout(v,5e3))},w=(e,t)=>{m&&m.connected?m.subscribe(e,(c=>{c?console.error("Error subscribing to topic ".concat(e,":"),c):(console.log("Subscribed to topic: ".concat(e)),g.add(e),y[e]||(y[e]=[]),y[e].push(t))})):console.warn("Cannot subscribe. MQTT not connected.")},S=e=>{m&&m.connected?m.unsubscribe(e,(t=>{t?console.error("Error unsubscribing from topic ".concat(e,":"),t):(console.log("Unsubscribed from topic: ".concat(e)),g.delete(e),delete y[e])})):console.warn("Cannot unsubscribe. MQTT not connected.")},C=(e,t)=>{var c,n;e&&t?(c=e,n=JSON.stringify(t),m&&m.connected?m.publish(c,n,{qos:1},(e=>{e?console.error("Error publishing to ".concat(c,":"),e):console.log("Published message to ".concat(c,": ").concat(n))})):console.warn("Cannot publish. MQTT not connected.")):console.error("Missing parameters for sendMQTTCommand")},E=(e,t)=>{w(e,t)},k="http://localhost:5000/api/dashboard",T=async()=>{try{return(await o.a.get("".concat(k,"/active-emulations"))).data}catch(e){throw console.error("Error fetching active emulations:",e),e}};var M=c(27);var N=()=>{const[e,t]=Object(n.useState)({}),[c,r]=Object(n.useState)([]),[s,a]=Object(n.useState)([]),[i,d]=Object(n.useState)([]),[b,h]=Object(n.useState)([]),[u,O]=Object(n.useState)({}),[x,m]=Object(n.useState)([]),p=Object(n.useRef)(null),g=Object(n.useRef)(null),y=Object(n.useRef)(null),f=Object(n.useCallback)(((e,t)=>{const c=parseFloat(t);switch(e){case"cpu":a((e=>[...e.slice(-49),c])),D("CPU",c,85);break;case"memory":d((e=>[...e.slice(-49),c])),D("Memory",c,90);break;case"network":h((e=>[...e.slice(-49),c]));break;case"devices":const n=JSON.parse(t);O((e=>Object(j.a)(Object(j.a)({},e),n)));break;default:console.warn("Unknown metric type:",e)}}),[]),w=Object(n.useCallback)((()=>{const e=document.getElementById("cpuChart").getContext("2d"),t=document.getElementById("memoryChart").getContext("2d"),c=document.getElementById("networkChart").getContext("2d");p.current=U(e,"CPU Usage"),g.current=U(t,"Memory Usage"),y.current=U(c,"Network Traffic")}),[]);Object(n.useEffect)((()=>{v(),C(),N(),w();const e={cpu:"system/cpu",memory:"system/memory",network:"system/network",devices:"devices/metrics"};return Object.entries(e).forEach((e=>{let[t,c]=e;E(c,(e=>f(t,e)))})),()=>{Object.values(e).forEach((e=>S(e))),p.current&&p.current.destroy(),g.current&&g.current.destroy(),y.current&&y.current.destroy()}}),[f,w]);const C=async()=>{try{const e=await(async()=>{try{return(await o.a.get("".concat(k,"/system-status"))).data}catch(e){throw console.error("Error fetching system status:",e),e}})();t(e)}catch(e){console.error("Error fetching system metrics:",e)}},N=async()=>{try{const e=await T();r(e)}catch(e){console.error("Error fetching active emulations:",e)}},D=(e,t,c)=>{t>c&&m((n=>[...n.slice(-4),"".concat(e," Usage HIGH: ").concat(t,"% (Threshold: ").concat(c,"%)")]))},U=(e,t)=>new M.a(e,{type:"line",data:{labels:Array(50).fill(""),datasets:[{label:t,data:[],borderColor:"rgba(75,192,192,1)",fill:!1}]},options:{responsive:!0,scales:{x:{display:!1},y:{beginAtZero:!0}}}});return Object(l.jsxs)("div",{className:"live-metrics",children:[Object(l.jsx)("h1",{children:"Live System Metrics"}),Object(l.jsxs)("div",{className:"metrics-container",children:[Object(l.jsxs)("div",{className:"metric-box",children:[Object(l.jsx)("h2",{children:"CPU Usage"}),Object(l.jsxs)("p",{children:[e.cpu,"%"]}),Object(l.jsx)("canvas",{id:"cpuChart"})]}),Object(l.jsxs)("div",{className:"metric-box",children:[Object(l.jsx)("h2",{children:"Memory Usage"}),Object(l.jsxs)("p",{children:[e.memory,"%"]}),Object(l.jsx)("canvas",{id:"memoryChart"})]}),Object(l.jsxs)("div",{className:"metric-box",children:[Object(l.jsx)("h2",{children:"Network Traffic"}),Object(l.jsxs)("p",{children:[e.network," Mbps"]}),Object(l.jsx)("canvas",{id:"networkChart"})]})]}),Object(l.jsx)("h2",{children:"Active Emulations"}),Object(l.jsx)("ul",{children:c.map((e=>Object(l.jsxs)("li",{children:[e.name," - ",e.status]},e.id)))}),Object(l.jsx)("h2",{children:"Device Telemetry"}),Object(l.jsx)("ul",{children:Object.entries(u).map((e=>{let[t,c]=e;return Object(l.jsxs)("li",{children:[t,": ",c]},t)}))}),x.length>0&&Object(l.jsxs)("div",{className:"alerts",children:[Object(l.jsx)("h2",{children:"Alerts"}),Object(l.jsx)("ul",{children:x.map(((e,t)=>Object(l.jsx)("li",{children:e},t)))})]})]})};c(40);var D=e=>{let{topic:t,onClose:c}=e;const[r,s]=Object(n.useState)([]),[a,o]=Object(n.useState)(""),[i,d]=Object(n.useState)(null);Object(n.useEffect)((()=>{const e=e=>{s((t=>[...t,e]))};return w(t,e),E(t,e),()=>{S(t)}}),[t]);return Object(l.jsxs)("div",{className:"modal",children:[Object(l.jsxs)("h3",{children:["Mirror Mode: ",t]}),Object(l.jsx)("div",{className:"message-box",children:r.length>0?r.map(((e,t)=>Object(l.jsx)("div",{className:"message",children:e},t))):Object(l.jsx)("p",{className:"empty-state",children:"No messages yet..."})}),Object(l.jsxs)("div",{className:"command-box",children:[Object(l.jsx)("input",{type:"text",value:a,onChange:e=>o(e.target.value),placeholder:"Enter command"}),Object(l.jsx)("button",{onClick:async()=>{if(""!==a.trim()){d("Sending...");try{await C(t,{command:a}),d("Command sent successfully!"),s((e=>[...e,"> Sent: ".concat(a)]))}catch(e){d("Error: Failed to send command.")}finally{o(""),setTimeout((()=>d(null)),3e3)}}},children:"Send"})]}),i&&Object(l.jsx)("p",{className:"status",children:i}),Object(l.jsx)("button",{className:"close-btn",onClick:c,children:"Close"})]})};var U=()=>{const[e,t]=Object(n.useState)([]),[c,r]=Object(n.useState)("");Object(n.useEffect)((()=>{T().then(t),T().then((e=>e(e)))}),[]);const s=e.filter((e=>Object.values(e).some((e=>e.toString().toLowerCase().includes(c.toLowerCase())))));return Object(l.jsxs)("div",{style:{maxHeight:"150px",overflowY:"scroll",background:"#fff",padding:"10px"},children:[Object(l.jsx)("h3",{children:"Active Emulations"}),Object(l.jsx)("input",{type:"text",placeholder:"Filter...",value:c,onChange:e=>r(e.target.value),style:{marginBottom:"10px"}}),Object(l.jsxs)("table",{children:[Object(l.jsx)("thead",{children:Object(l.jsxs)("tr",{children:[Object(l.jsx)("th",{children:"Name"}),Object(l.jsx)("th",{children:"Status"}),Object(l.jsx)("th",{children:"Type"})]})}),Object(l.jsx)("tbody",{children:s.map(((e,t)=>Object(l.jsxs)("tr",{children:[Object(l.jsx)("td",{children:e.name}),Object(l.jsx)("td",{children:e.status}),Object(l.jsx)("td",{children:e.type})]},t)))})]})]})};var R=()=>Object(l.jsxs)("div",{style:{display:"flex",flexDirection:"row",height:"100vh"},children:[Object(l.jsxs)("div",{style:{flex:1,padding:"10px",background:"#f5f5f5"},children:[Object(l.jsx)("h1",{children:"Hardware Emulator Dashboard"}),Object(l.jsx)(d,{})]}),Object(l.jsxs)("div",{style:{flex:1,padding:"10px",background:"#e5e5e5"},children:[Object(l.jsx)("h1",{children:"Hardware Emulator Dashboard"}),Object(l.jsx)(h,{})]}),Object(l.jsxs)("div",{style:{flex:1,padding:"10px",background:"#d5d5d5"},children:[Object(l.jsx)("h1",{children:"Hardware Emulator Dashboard"}),Object(l.jsx)(O,{})]}),Object(l.jsxs)("div",{style:{flex:1,padding:"10px",background:"#c5c5c5"},children:[Object(l.jsx)("h1",{children:"Hardware Emulator Dashboard"}),Object(l.jsx)(x,{})]}),Object(l.jsxs)("div",{style:{flex:1,padding:"10px",background:"#c5c5c5"},children:[Object(l.jsx)("h1",{children:"Hardware Emulator Dashboard"}),Object(l.jsx)(N,{})]}),Object(l.jsxs)("div",{style:{flex:1,padding:"10px",background:"#c5c5c5"},children:[Object(l.jsx)("h1",{children:"Hardware Emulator Dashboard"}),Object(l.jsx)(D,{})]}),Object(l.jsxs)("div",{style:{flex:1,padding:"10px",background:"#c5c5c5"},children:[Object(l.jsx)("h1",{children:"Hardware Emulator Dashboard"}),Object(l.jsx)(U,{})]})]});c(41);var Q=function(){return Object(l.jsxs)("div",{className:"App",children:[Object(l.jsx)("h1",{children:"Universal Hardware Tester"}),Object(l.jsx)(R,{})]})};a.a.createRoot(document.getElementById("root")).render(Object(l.jsx)(Q,{})).render(Object(l.jsx)(r.a.StrictMode,{children:Object(l.jsx)(Q,{})}))}},[[42,1,2]]]);
//# sourceMappingURL=main.72bf870b.chunk.js.map
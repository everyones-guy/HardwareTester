{% extends "base.html" %}

{% block title %}Hardware Emulator{% endblock %}

{% block extra_styles %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/emulator.css') }}">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jsoneditor@9.7.0/dist/jsoneditor.min.css" />
{% endblock %}

{% block content %}
<div class="sidebar">
    <h2>Emulator Dashboard</h2>
    <a href="#available-blueprints" class="active">Available Blueprints</a>
    <a href="#active-emulations">Active Emulations</a>
    <a href="#start-emulation">Start Emulation</a>
    <a href="#emulator-logs">Emulator Logs</a>
    <a href="#add-emulator">Add Emulator</a>
    <a href="#json-preview">JSON Preview</a>
</div>

<div class="content">
    <div class="content-header">Hardware Emulator</div>

    <div id="available-blueprints" class="card col-100">
        <div class="card-header">Available Blueprints</div>
        <div class="card-body">
            <ul id="blueprint-list" class="list-group">
                {% for blueprint in blueprints %}
                <li class="list-group-item">
                    <strong>{{ blueprint.name }}</strong> - {{ blueprint.description }}
                    <button class="btn">Preview</button>
                </li>
                {% else %}
                <li class="list-group-item text-muted">No blueprints available.</li>
                {% endfor %}
            </ul>
            <button class="btn">Refresh Blueprints</button>
        </div>
    </div>

    <div id="active-emulations" class="card col-50">
        <div class="card-header">Active Emulations</div>
        <div class="card-body">
            <ul id="active-emulations-list" class="list-group">
                <li class="list-group-item text-muted">No active emulations.</li>
            </ul>
            <button class="btn">Refresh Emulations</button>
        </div>
    </div>

    <div id="start-emulation" class="card col-50">
        <div class="card-header">Start Emulation</div>
        <div class="card-body">
            <form>
                <input type="text" placeholder="Machine Name" class="form-control">
                <select class="form-control">
                    <option>Select Blueprint</option>
                </select>
                <div>
                    <input type="checkbox"> Stress Test
                </div>
                <button class="btn">Start Emulation</button>
            </form>
        </div>
    </div>

    <div id="emulator-logs" class="card col-100">
        <div class="card-header">Emulator Logs</div>
        <div class="card-body">
            <div id="emulator-logs"></div>
            <button class="btn">Refresh Logs</button>
        </div>
    </div>

    <div id="add-emulator" class="card col-50">
        <div class="card-header">Add New Emulator</div>
        <div class="card-body">
            <button class="btn">Add Emulator</button>
        </div>
    </div>

    <div id="json-preview" class="card col-50">
        <div class="card-header">JSON Preview</div>
        <div class="card-body">
            <button class="btn">Upload and Preview JSON</button>
        </div>
    </div>
</div>

<!-- Modal: JSON Preview -->
<div class="modal fade" id="json-preview-modal" tabindex="-1" aria-labelledby="jsonPreviewModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header bg-warning text-dark">
                <h5 class="modal-title" id="jsonPreviewModalLabel">JSON Preview and Edit</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <!-- File Upload -->
                <div class="mb-3">
                    <label for="upload-json-file" class="form-label">Upload JSON File</label>
                    <input type="file" id="upload-json-file" name="json_file" class="form-control" accept=".json">
                </div>
                <!-- JSON Editor -->
                <div id="json-editor" style="height: 300px; border: 1px solid #ccc; margin-bottom: 15px;"></div>
                <!-- Action Buttons -->
                <button class="btn btn-primary w-100" id="save-json-button">Save Changes</button>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block additional_scripts %}
<script src="{{ url_for('static', filename='js/emulator.js') }}"></script>
<script src="https://cdn.jsdelivr.net/npm/jsoneditor@9.7.0/dist/jsoneditor.min.js"></script>
{% endblock %}
